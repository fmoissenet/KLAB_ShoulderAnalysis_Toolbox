% MAIN PROGRAM
% Scaling_Example
%__________________________________________________________________________
%
% PURPOSE
% 3D scaling example
%
% SYNOPSIS
% N/A (i.e., main program)
%
% DESCRIPTION
% Plotting of a scaled model (dummy leg) using the three scaling methods,
% comparison of geometrical parameters of the transformation (rotation, 
% translation, homothety, stretch)
%__________________________________________________________________________
%
% CALLED FUNCTIONS (FROM 3D SCALING TOOLBOX) 
% Affine_3D_Approximation.m
% Kriging_3D_Interpolation.m
% RBF_3D_Approximation.m
% 
% MATLAB VERSION
% Matlab R2007b
%__________________________________________________________________________
%
% CHANGELOG
% Created by Raphaël Dumas
% July 2011
%__________________________________________________________________________

%__________________________________________________________________________
%
% Control Points
% Lower limb anatomical landmarks for male and female dummy specification 
%__________________________________________________________________________

% Initial Control points (male)
Xi = [0.68798 -0.058783	-0.14167 % Sphyrion (lateral maleolus)
0.80175	-0.07729	-0.077975 % Metatarsal head 1
0.77991	-0.16964	-0.1121 % Metatarsal head 5
0.70414	-0.092575	-0.24154 % Calcaneum
0.048857	0	0.03603 % Pubic symphisis
0.39494	-0.082993	0.15122 % Medial epicondyle
0.38595	-0.18855	0.14916 % Lateral epicondyle
0.019286    -0.20528	-0.009063]; % Throchanter

% Final Control points (female)
Xj = [0.599	-0.057	-0.172 % Sphyrion (lateral maleolus)
0.698	-0.076	-0.12 % Metatarsal head 1
0.683	-0.157	-0.147  % Metatarsal head 5
0.618	-0.101	-0.254 % Calcaneum
0.044	0	0.032 % Pubic symphisis
0.365	-0.032	0.069 % Medial epicondyle
0.36	-0.119	0.072 % Lateral epicondyle
0.018	-0.19	-0.018]; % Throchanter

%__________________________________________________________________________
%
% Initial Mesh
% Male dummy leg 
%__________________________________________________________________________

% Nodes
Meshi = [0.70533	-0.07577	-0.11511
0.69708	-0.065764	-0.12772
0.68798	-0.058783	-0.14167
0.67831	-0.059056	-0.15659
0.66906	-0.065157	-0.17092
0.66039	-0.073515	-0.18437
0.65443	-0.087479	-0.19372
0.65376	-0.10371	-0.19494
0.65851	-0.11903	-0.18778
0.66685	-0.12827	-0.17502
0.67633	-0.13217	-0.16044
0.68596	-0.13007	-0.14557
0.69524	-0.12483	-0.1312
0.70367	-0.11619	-0.11811
0.71014	-0.096167	-0.10792
0.70918	-0.084861	-0.10928
0.81671	-0.1209	-0.04122
0.81852	-0.13512	-0.041103
0.8221	-0.14884	-0.042613
0.83054	-0.1569	-0.049107
0.83912	-0.099392	-0.063637
0.83291	-0.089831	-0.059298
0.82396	-0.086247	-0.051819
0.81477	-0.10349	-0.041601
0.81572	-0.1122	-0.041394
0.81357	-0.15093	-0.053532
0.81065	-0.13628	-0.051624
0.82257	-0.16375	-0.061914
0.83583	-0.15374	-0.069741
0.83892	-0.13955	-0.073999
0.83919	-0.12523	-0.075898
0.83771	-0.11129	-0.075803
0.83453	-0.098386	-0.073722
0.82824	-0.086975	-0.069002
0.81556	-0.08139	-0.060786
0.80825	-0.090033	-0.050328
0.80718	-0.10172	-0.048491
0.80872	-0.11229	-0.048627
0.80997	-0.12284	-0.049419
0.70226	-0.061115	-0.15006
0.69266	-0.059557	-0.16678
0.71105	-0.066401	-0.1312
0.71649	-0.073153	-0.11895
0.72286	-0.084259	-0.10622
0.72075	-0.10247	-0.10535
0.7199	-0.12185	-0.11729
0.70939	-0.13027	-0.13406
0.69977	-0.13272	-0.15204
0.69152	-0.13325	-0.16502
0.67966	-0.13178	-0.18216
0.66693	-0.12262	-0.19785
0.66052	-0.10451	-0.20682
0.66158	-0.085142	-0.20512
0.66987	-0.070118	-0.19542
0.6829	-0.06199	-0.18094
0.79971	-0.11347	-0.056518
0.79839	-0.10158	-0.055286
0.80154	-0.12591	-0.0578
0.80407	-0.13868	-0.059793
0.80683	-0.15118	-0.061895
0.81136	-0.16243	-0.066212
0.83169	-0.15591	-0.083545
0.83452	-0.14118	-0.086941
0.8345	-0.12608	-0.08832
0.83265	-0.1111	-0.087587
0.8291	-0.097474	-0.084938
0.82282	-0.085662	-0.080354
0.81286	-0.079056	-0.074311
0.79891	-0.08975	-0.055985
0.82234	-0.16735	-0.078497
0.8104	-0.16768	-0.077649
0.80338	-0.080894	-0.06149
0.71661	-0.06583	-0.15726
0.70701	-0.062065	-0.17874
0.72435	-0.068147	-0.14054
0.73062	-0.07122	-0.12364
0.7353	-0.076497	-0.10939
0.7336	-0.10509	-0.099595
0.73571	-0.12039	-0.10646
0.72057	-0.13885	-0.14202
0.7118	-0.13819	-0.15969
0.70183	-0.13545	-0.17683
0.68506	-0.13282	-0.19896
0.67546	-0.12743	-0.20964
0.6683	-0.10638	-0.22305
0.6737	-0.077247	-0.21792
0.68137	-0.066512	-0.20695
0.69552	-0.061096	-0.1919
0.73445	-0.089804	-0.09776
0.74038	-0.079811	-0.10143
0.7299	-0.13624	-0.12575
0.74054	-0.1345	-0.11349
0.80821	-0.078561	-0.083601
0.79414	-0.079926	-0.06645
0.79022	-0.089038	-0.061141
0.78903	-0.10091	-0.061452
0.78986	-0.11416	-0.063571
0.79191	-0.12851	-0.065685
0.79668	-0.14132	-0.067284
0.80071	-0.15118	-0.068378
0.80431	-0.15873	-0.068775
0.80404	-0.16361	-0.074978
0.80144	-0.16494	-0.079422
0.80606	-0.16908	-0.082326
0.81626	-0.16934	-0.08933
0.82494	-0.15836	-0.096684
0.82811	-0.14273	-0.10039
0.82816	-0.12639	-0.10124
0.82642	-0.11091	-0.099548
0.82266	-0.096833	-0.096209
0.81677	-0.085147	-0.09065
0.75001	-0.13444	-0.10406
0.75359	-0.1447	-0.10858
0.74702	-0.14615	-0.11859
0.74717	-0.12134	-0.098091
0.74003	-0.14743	-0.13202
0.73274	-0.14728	-0.1487
0.72603	-0.1455	-0.16344
0.71574	-0.14059	-0.18481
0.70398	-0.13771	-0.20215
0.68803	-0.13125	-0.22274
0.68232	-0.080438	-0.2326
0.69876	-0.067	-0.22513
0.71909	-0.062827	-0.20174
0.73	-0.066586	-0.18406
0.73313	-0.070506	-0.15878
0.73861	-0.072527	-0.14456
0.74331	-0.072603	-0.1269
0.74515	-0.074284	-0.11209
0.74509	-0.07644	-0.10536
0.75075	-0.075977	-0.10395
0.74842	-0.080132	-0.096337
0.7449	-0.091966	-0.091046
0.74507	-0.10672	-0.092956
0.67575	-0.10447	-0.23475
0.69167	-0.11086	-0.23979
0.79456	-0.076677	-0.080015
0.78707	-0.078976	-0.071579
0.78217	-0.087525	-0.0665
0.77913	-0.098687	-0.067625
0.77913	-0.11389	-0.070799
0.78116	-0.13281	-0.075235
0.79057	-0.14643	-0.074656
0.79713	-0.1558	-0.074382
0.79577	-0.16128	-0.080529
0.79787	-0.1686	-0.086621
0.80661	-0.17078	-0.097894
0.81404	-0.15956	-0.10708
0.81669	-0.14355	-0.11109
0.81669	-0.12634	-0.11192
0.81655	-0.11098	-0.10934
0.81312	-0.09684	-0.10616
0.80891	-0.084988	-0.099581
0.80083	-0.078073	-0.091069
0.7609	-0.14666	-0.10194
0.76387	-0.15605	-0.10707
0.75725	-0.15263	-0.11242
0.75896	-0.13614	-0.096435
0.75517	-0.15555	-0.12126
0.75191	-0.15717	-0.1365
0.74635	-0.15281	-0.15574
0.74226	-0.14685	-0.17486
0.73327	-0.14219	-0.1932
0.72097	-0.13871	-0.20957
0.708	-0.13078	-0.23065
0.72918	-0.10757	-0.23164
0.70414	-0.092575	-0.24154
0.71661	-0.067565	-0.22696
0.72536	-0.066759	-0.21597
0.73716	-0.076703	-0.20839
0.74884	-0.082006	-0.16213
0.75232	-0.079325	-0.14608
0.75619	-0.07637	-0.12868
0.75741	-0.074511	-0.10979
0.76078	-0.07748	-0.09294
0.75598	-0.092102	-0.083703
0.75616	-0.10812	-0.085563
0.75766	-0.12327	-0.090359
0.74506	-0.081122	-0.1786
0.74445	-0.090145	-0.19605
0.78755	-0.1551	-0.082897
0.78713	-0.16508	-0.09152
0.7943	-0.17126	-0.10521
0.80116	-0.16255	-0.11687
0.80499	-0.14473	-0.1221
0.80325	-0.12441	-0.1239
0.80674	-0.11103	-0.11719
0.80097	-0.096829	-0.11552
0.8012	-0.085543	-0.10656
0.79064	-0.077761	-0.10057
0.78541	-0.075946	-0.086566
0.77487	-0.085798	-0.071878
0.76846	-0.092792	-0.074696
0.76765	-0.11039	-0.077853
0.76844	-0.12678	-0.08287
0.77719	-0.14684	-0.085838
0.76782	-0.13969	-0.090109
0.73588	-0.086925	-0.21968
0.74239	-0.10109	-0.20669
0.7458	-0.10741	-0.19813
0.74841	-0.10162	-0.18905
0.75228	-0.099001	-0.17583
0.75745	-0.094906	-0.16092
0.76387	-0.089737	-0.14591
0.76933	-0.08373	-0.13054
0.77307	-0.077707	-0.11482
0.7755	-0.075399	-0.099436
0.7678	-0.14851	-0.096002
0.77387	-0.15823	-0.097384
0.77991	-0.16964	-0.1121
0.76567	-0.16382	-0.11924
0.77277	-0.16246	-0.13822
0.76656	-0.14944	-0.15608
0.74155	-0.13137	-0.19999
0.73967	-0.11992	-0.2108
0.77041	-0.078788	-0.082073
0.77672	-0.075811	-0.089407
0.74582	-0.11851	-0.19687
0.75084	-0.11663	-0.18534
0.757	-0.11467	-0.17221
0.76593	-0.10919	-0.15873
0.77453	-0.1022	-0.14498
0.78168	-0.094324	-0.13072
0.78745	-0.085357	-0.11654
0.77913	-0.078424	-0.076917
0.74559	-0.12945	-0.19276
0.75061	-0.12968	-0.18277
0.75705	-0.1331	-0.17165
0.76872	-0.1278	-0.16039
0.78423	-0.11652	-0.14294
0.79311	-0.10772	-0.12882
0.77819	-0.13964	-0.15203
0.79193	-0.13232	-0.13885
0.79505	-0.15055	-0.13282
0.78932	-0.16391	-0.1281
0.78408	-0.15139	-0.14342
0.80175	-0.07729	-0.077975
0.747	-0.14016	-0.18235
0.80572	-0.078374	-0.069447
0.74489	-0.13691	-0.18884
0.83967	-0.15152	-0.057832
0.84392	-0.13911	-0.06309
0.84487	-0.12521	-0.06561
0.8433	-0.1127	-0.065726
0.81653	-0.09157	-0.044598
0.81853	-0.13499	-0.041126
0.822	-0.14863	-0.042551
0.83395	-0.092226	-0.043315
0.84126	-0.097021	-0.051293
0.8256	-0.095535	-0.036811
0.81876	-0.10357	-0.037841
0.82235	-0.11205	-0.034322
0.82346	-0.12098	-0.033932
0.82619	-0.13201	-0.032226
0.82865	-0.14292	-0.032837
0.84017	-0.1476	-0.038952
0.84504	-0.14044	-0.047173
0.84759	-0.13057	-0.052988
0.84774	-0.12022	-0.055895
0.84544	-0.11275	-0.060276
0.84453	-0.10509	-0.056384
0.84217	-0.098282	-0.035873
0.84745	-0.10468	-0.044258
0.83267	-0.10018	-0.030019
0.82535	-0.10434	-0.032219
0.82893	-0.11166	-0.029058
0.83064	-0.11983	-0.028206
0.83297	-0.12883	-0.02749
0.83429	-0.13651	-0.027383
0.84452	-0.13541	-0.030042
0.84879	-0.1303	-0.038637
0.84964	-0.12199	-0.045226
0.8484	-0.11294	-0.050764
0.84987	-0.114	-0.038059
0.84798	-0.10788	-0.030629
0.83538	-0.10877	-0.025399
0.83737	-0.11822	-0.023811
0.84168	-0.12708	-0.026325
0.84894	-0.12212	-0.032086
0.84794	-0.1163	-0.027421
0.69774	-0.09564	-0.10501
0.69123	-0.11103	-0.10906
0.7038	-0.085851	-0.10792
0.6947	-0.079774	-0.11043
0.68539	-0.070926	-0.11829
0.67408	-0.062187	-0.13005
0.66195	-0.064513	-0.14706
0.65454	-0.070797	-0.16403
0.64964	-0.078466	-0.17758
0.64976	-0.087102	-0.18783
0.64493	-0.098616	-0.18586
0.64498	-0.11312	-0.17886
0.65189	-0.1244	-0.16644
0.66164	-0.12982	-0.15113
0.67184	-0.12898	-0.13524
0.68475	-0.12193	-0.11937
0.68712	-0.088602	-0.1038
0.67545	-0.078696	-0.10717
0.66103	-0.067013	-0.11693
0.6412	-0.071011	-0.13777
0.63914	-0.078219	-0.1599
0.63929	-0.087809	-0.17527
0.63343	-0.10443	-0.17146
0.63767	-0.11998	-0.16114
0.64633	-0.12787	-0.14551
0.65705	-0.12927	-0.12755
0.66861	-0.12214	-0.10749
0.67955	-0.1043	-0.10112
0.66699	-0.085921	-0.096898
0.65083	-0.073559	-0.10163
0.63159	-0.070599	-0.1171
0.62538	-0.093004	-0.16066
0.61974	-0.083662	-0.14426
0.61424	-0.079127	-0.12837
0.62292	-0.11165	-0.15655
0.62915	-0.12589	-0.14281
0.64007	-0.13081	-0.123
0.65039	-0.12898	-0.1027
0.65535	-0.1156	-0.086519
0.63893	-0.078238	-0.088738
0.62144	-0.071428	-0.10244
0.60632	-0.077064	-0.11421
0.5938	-0.08869	-0.12312
0.59971	-0.097717	-0.13556
0.61119	-0.10262	-0.14728
0.61239	-0.12205	-0.1403
0.61232	-0.13365	-0.12021
0.62687	-0.13662	-0.092201
0.64082	-0.12102	-0.073961
0.6384	-0.099402	-0.069641
0.64627	-0.091418	-0.080141
0.62666	-0.082028	-0.076061
0.61032	-0.072679	-0.088677
0.59736	-0.075935	-0.10107
0.58893	-0.083001	-0.11063
0.57594	-0.088438	-0.10685
0.58219	-0.099112	-0.12106
0.59287	-0.1131	-0.13264
0.58981	-0.13528	-0.11699
0.60235	-0.14282	-0.092952
0.62771	-0.12375	-0.060095
0.62516	-0.10273	-0.056444
0.61361	-0.084937	-0.062756
0.61881	-0.13965	-0.071188
0.60592	-0.14475	-0.078066
0.59752	-0.074057	-0.075324
0.58061	-0.078054	-0.090601
0.57176	-0.075956	-0.072922
0.56299	-0.096702	-0.10404
0.56834	-0.11144	-0.11511
0.57049	-0.14373	-0.10179
0.5529	-0.12294	-0.10664
0.58528	-0.14826	-0.085693
0.60075	-0.14784	-0.06651
0.60974	-0.14264	-0.057253
0.61546	-0.12701	-0.046273
0.61202	-0.10607	-0.042364
0.60033	-0.087368	-0.048439
0.58574	-0.075608	-0.060133
0.56229	-0.085859	-0.091189
0.56111	-0.080544	-0.079187
0.54704	-0.10528	-0.09758
0.52942	-0.11311	-0.089308
0.53601	-0.13279	-0.096211
0.55404	-0.1509	-0.0881
0.57146	-0.15406	-0.073944
0.58807	-0.15298	-0.061531
0.59854	-0.14728	-0.04438
0.60343	-0.13005	-0.03185
0.59923	-0.10833	-0.028229
0.58776	-0.089149	-0.034221
0.57364	-0.076861	-0.045813
0.55975	-0.07561	-0.060446
0.5495	-0.081756	-0.073076
0.54658	-0.090938	-0.085825
0.43277	-0.084035	0.046068
0.42871	-0.081787	0.077215
0.41519	-0.11308	0.041082
0.41173	-0.15557	0.054014
0.4128	-0.17455	0.070401
0.41531	-0.18562	0.10417
0.42195	-0.18295	0.14245
0.42157	-0.17664	0.17504
0.40859	-0.14253	0.20278
0.40138	-0.12182	0.19489
0.41496	-0.10811	0.18078
0.42413	-0.092843	0.15426
0.43054	-0.087147	0.12828
0.43053	-0.083771	0.10251
0.52939	-0.095429	-0.079029
0.51087	-0.09944	-0.071161
0.51217	-0.12002	-0.080703
0.51983	-0.14192	-0.084963
0.53804	-0.15774	-0.074424
0.55593	-0.16087	-0.059949
0.57246	-0.16032	-0.045997
0.58465	-0.15396	-0.030366
0.59014	-0.13457	-0.015983
0.58512	-0.11133	-0.01132
0.57342	-0.090444	-0.017671
0.558	-0.07692	-0.030329
0.54413	-0.075002	-0.048352
0.53429	-0.082342	-0.064892
0.43665	-0.12468	0.18424
0.45328	-0.16307	0.16083
0.44958	-0.1142	0.15329
0.45471	-0.099841	0.12654
0.45593	-0.087745	0.10131
0.45384	-0.079236	0.075477
0.45398	-0.074851	0.051049
0.42141	-0.12217	0.021129
0.42428	-0.16888	0.030146
0.43303	-0.18516	0.054052
0.44304	-0.18602	0.095032
0.44906	-0.17795	0.12972
0.4372	-0.087632	0.025557
0.45686	-0.074512	0.03016
0.51623	-0.083225	-0.056609
0.49681	-0.085309	-0.048196
0.49193	-0.10432	-0.062382
0.49323	-0.12918	-0.070023
0.50514	-0.15533	-0.06858
0.5238	-0.16669	-0.05498
0.54468	-0.16808	-0.041239
0.56102	-0.16611	-0.027837
0.5733	-0.15763	-0.013381
0.57699	-0.13983	-5.16E-04
0.5702	-0.11553	0.0080397
0.5585	-0.091312	3.40E-04
0.53767	-0.075125	-0.012431
0.52555	-0.074197	-0.037216
0.4723	-0.13877	0.14257
0.48413	-0.12783	0.12088
0.48216	-0.10073	0.096719
0.4821	-0.084289	0.074518
0.47967	-0.074347	0.051141
0.47824	-0.070375	0.028084
0.44671	-0.093425	-0.004668
0.43458	-0.12679	-0.009759
0.43661	-0.17077	0.0092654
0.4559	-0.18684	0.046096
0.47232	-0.18264	0.084395
0.47765	-0.16437	0.11799
0.50398	-0.074708	-0.029563
0.48303	-0.077513	-0.021815
0.47782	-0.089188	-0.03853
0.47273	-0.10958	-0.050622
0.47336	-0.13742	-0.055234
0.49003	-0.16782	-0.045934
0.51515	-0.1748	-0.032281
0.53563	-0.17397	-0.020855
0.55161	-0.16996	-0.010428
0.56334	-0.16092	-6.29E-04
0.56505	-0.14776	0.011566
0.56114	-0.13082	0.022003
0.54796	-0.093881	0.016789
0.53274	-0.079825	0.011203
0.5582	-0.10808	0.01855
0.55187	-0.11642	0.030842
0.51231	-0.0711	-0.008562
0.51569	-0.072688	0.009598
0.49963	-0.1435	0.10386
0.50674	-0.11948	0.087469
0.50695	-0.096084	0.067359
0.50393	-0.080313	0.047957
0.47277	-0.17882	-0.012731
0.48875	-0.18499	0.030532
0.51381	-0.16625	0.066715
0.46514	-0.083495	-0.015299
0.46186	-0.095551	-0.029382
0.45617	-0.11312	-0.035971
0.45594	-0.13404	-0.039813
0.50847	-0.18049	-0.004637
0.53065	-0.17675	7.44E-04
0.54499	-0.17142	0.0055217
0.55496	-0.1636	0.0091915
0.55492	-0.15479	0.020459
0.55184	-0.14351	0.031764
0.54417	-0.12898	0.043708
0.52941	-0.10865	0.053791
0.53988	-0.099602	0.033614
0.52541	-0.083515	0.029132
0.50339	-0.072003	0.023451
0.48882	-0.071017	-2.34E-04
0.45122	-0.098522	-0.018581
0.44597	-0.11257	-0.022436
0.51403	-0.18053	0.024943
0.52516	-0.1353	0.069996
0.5209	-0.089652	0.044619
0.53598	-0.14831	0.051306
0.54257	-0.15659	0.036379
0.54483	-0.16589	0.02172
0.53167	-0.17472	0.02122
0.52468	-0.16867	0.047543
0.53327	-0.16853	0.035006
0.47344	-0.07351	0.0038088
0.45647	-0.079302	0.009289
0.66569	-0.099691	-0.091307
0.65388	-0.10403	-0.08217
0.70533	-0.07577	-0.11511
0.69708	-0.065764	-0.12772
0.68798	-0.058783	-0.14167
0.67831	-0.059056	-0.15659
0.66906	-0.065157	-0.17092
0.66039	-0.073515	-0.18437
0.65443	-0.087479	-0.19372
0.65376	-0.10371	-0.19494
0.65851	-0.11903	-0.18778
0.66685	-0.12827	-0.17502
0.67633	-0.13217	-0.16044
0.68596	-0.13007	-0.14557
0.69524	-0.12483	-0.1312
0.70367	-0.11619	-0.11811
0.71014	-0.096167	-0.10791
0.70918	-0.084861	-0.10928
0.38918	-0.097587	0.072968
0.39126	-0.1698	0.078766
0.39125	-0.18929	0.12259
0.38595	-0.18855	0.14916
0.38384	-0.17785	0.17646
0.3798	-0.14819	0.19692
0.38033	-0.11635	0.18923
0.38835	-0.092335	0.17162
0.39494	-0.082993	0.15122
0.40388	-0.082589	0.12624
0.4078	-0.083208	0.10048
0.40562	-0.13631	0.066184
0.406	-0.10976	0.063908
0.40512	-0.086985	0.081631
0.3798	-0.14819	0.19692
0.35243	-0.14676	0.18874
0.38033	-0.11635	0.18923
0.38384	-0.17785	0.17646
0.35596	-0.11874	0.18514
0.35463	-0.17536	0.17431
0.32376	-0.14355	0.18068
0.36329	-0.096222	0.17043
0.38835	-0.092335	0.17162
0.38595	-0.18855	0.14916
0.32863	-0.11666	0.17699
0.32392	-0.16936	0.1708
0.35807	-0.19049	0.14936
0.33642	-0.094014	0.16317
0.32834	-0.18777	0.15098
0.39494	-0.082993	0.15122
0.37191	-0.080513	0.148
0.39125	-0.18929	0.12259
0.29653	-0.14081	0.17231
0.30136	-0.11311	0.16917
0.29623	-0.16741	0.16342
0.36389	-0.19521	0.1188
0.34558	-0.078322	0.14138
0.40388	-0.082589	0.12624
0.30957	-0.08993	0.15474
0.37954	-0.079049	0.12144
0.30066	-0.18701	0.14463
0.34257	-0.19829	0.11475
0.3552	-0.072778	0.11548
0.31923	-0.074939	0.13299
0.36667	-0.19237	0.090513
0.26879	-0.13822	0.16401
0.30766	-0.19874	0.12086
0.38694	-0.081067	0.10188
0.27379	-0.10945	0.16078
0.4078	-0.083208	0.10048
0.34647	-0.1976	0.093123
0.26811	-0.16604	0.15555
0.39126	-0.1698	0.078765
0.28211	-0.08555	0.14649
0.27212	-0.18719	0.13651
0.36373	-0.07603	0.089246
0.32932	-0.068017	0.10696
0.31627	-0.20215	0.094992
0.38358	-0.13451	0.065243
0.37702	-0.15994	0.064998
0.40512	-0.086985	0.081631
0.40562	-0.13631	0.066184
0.38918	-0.097587	0.072968
0.36308	-0.18018	0.065804
0.34605	-0.19397	0.0724
0.29229	-0.070176	0.12384
0.406	-0.10976	0.063907
0.27916	-0.20029	0.11199
0.36988	-0.090732	0.064457
0.33864	-0.070117	0.080307
0.36609	-0.11675	0.054568
0.32509	-0.19822	0.069483
0.36091	-0.14413	0.050753
0.23862	-0.13394	0.15499
0.35285	-0.16794	0.052134
0.34379	-0.18331	0.056142
0.23915	-0.16334	0.14774
0.2436	-0.10435	0.1505
0.30264	-0.063867	0.097351
0.28808	-0.20539	0.085256
0.24451	-0.18587	0.12944
0.25231	-0.079823	0.13528
0.34641	-0.081953	0.054679
0.32686	-0.18427	0.047941
0.34604	-0.10749	0.042156
0.33699	-0.16143	0.039443
0.34273	-0.13517	0.036967
0.25265	-0.19985	0.10445
0.31236	-0.065236	0.069756
0.26271	-0.064141	0.11237
0.29832	-0.20031	0.058593
0.2614	-0.20487	0.078044
0.30831	-0.18238	0.037442
0.2732	-0.058352	0.085079
0.32066	-0.073953	0.043387
0.20906	-0.16111	0.13928
0.2066	-0.12974	0.14533
0.31592	-0.15659	0.025808
0.21271	-0.098873	0.13982
0.21603	-0.18474	0.12178
0.3227	-0.098699	0.028471
0.32087	-0.1273	0.02292
0.27134	-0.20007	0.051486
0.22223	-0.073998	0.12399
0.2253	-0.1993	0.096933
0.28279	-0.060414	0.057028
0.23301	-0.058087	0.10087
0.28109	-0.18345	0.029371
0.23405	-0.20434	0.070503
0.28827	-0.15822	0.015785
0.29079	-0.072035	0.029855
0.292	-0.12861	0.011281
0.29275	-0.098586	0.015514
0.24355	-0.052885	0.073116
0.24371	-0.19978	0.044252
0.17838	-0.16041	0.12989
0.18746	-0.1844	0.11313
0.1815	-0.092576	0.12861
0.19756	-0.19883	0.089047
0.25295	-0.055598	0.044597
0.25318	-0.18436	0.021505
0.16992	-0.12551	0.13431
0.19242	-0.067915	0.11256
0.25982	-0.16013	0.0058286
0.20644	-0.20381	0.062677
0.20352	-0.05212	0.089519
0.26018	-0.069589	0.016839
0.26232	-0.13005	-0.000657
0.26132	-0.098216	0.002089
0.21583	-0.19946	0.03694
0.214	-0.047507	0.061728
0.15991	-0.18686	0.10483
0.15088	-0.16483	0.12104
0.22488	-0.18525	0.013946
0.17015	-0.20073	0.080867
0.223	-0.050703	0.033041
0.14299	-0.13893	0.12712
0.15372	-0.083117	0.11723
0.14423	-0.10698	0.12467
0.23091	-0.16259	-0.003572
0.16375	-0.06084	0.10146
0.17878	-0.20524	0.05478
0.23203	-0.13275	-0.012708
0.22889	-0.065789	0.0048593
0.17443	-0.045615	0.078463
0.18805	-0.20051	0.029218
0.12838	-0.12242	0.1235
0.22568	-0.09754	-0.012995
0.1847	-0.041842	0.050939
0.19687	-0.18701	0.0062204
0.12426	-0.16855	0.11324
0.13218	-0.19041	0.096407
0.11889	-0.14284	0.12049
0.14186	-0.20356	0.072475
0.20313	-0.1665	-0.012395
0.19367	-0.045493	0.023065
0.12062	-0.099363	0.11624
0.12707	-0.076227	0.10712
0.15075	-0.20734	0.046618
0.20512	-0.14002	-0.023684
0.13535	-0.054355	0.091252
0.1997	-0.058842	-0.002982
0.20486	-0.07964	-0.016035
0.10705	-0.12081	0.1178
0.16009	-0.20199	0.02117
0.20113	-0.11313	-0.026438
0.14536	-0.039068	0.068017
0.16881	-0.18891	-0.001668
0.1046	-0.13723	0.093751
0.10747	-0.15613	0.086048
0.11257	-0.14191	0.072832
0.096741	-0.14652	0.11425
0.10904	-0.12508	0.082259
0.10104	-0.12232	0.10323
0.099878	-0.17282	0.10577
0.15567	-0.035883	0.04041
0.11205	-0.17172	0.073908
0.11611	-0.1569	0.063412
0.096521	-0.12182	0.11508
0.1053	-0.10997	0.092207
0.11762	-0.12958	0.059738
0.11365	-0.11143	0.070309
0.1923	-0.093744	-0.027138
0.12103	-0.14685	0.050639
0.11843	-0.17325	0.057178
0.10621	-0.1936	0.088973
0.098397	-0.099508	0.11039
0.11628	-0.19005	0.062642
0.10913	-0.092967	0.082353
0.12418	-0.16468	0.042191
0.17571	-0.17006	-0.020884
0.12268	-0.11653	0.046623
0.12686	-0.13719	0.035446
0.11888	-0.098028	0.056745
0.12447	-0.18245	0.041244
0.1151	-0.20606	0.065549
0.12697	-0.11843	0.035356
0.12847	-0.12783	0.031321
0.12914	-0.15773	0.029271
0.10203	-0.076462	0.10112
0.16521	-0.040142	0.013046
0.12674	-0.10301	0.03612
0.11457	-0.076396	0.068268
0.13231	-0.13644	0.021189
0.13186	-0.12362	0.022501
0.13049	-0.11115	0.026216
0.12406	-0.086439	0.043306
0.13167	-0.17801	0.02243
0.17979	-0.14575	-0.033692
0.13471	-0.15141	0.014738
0.12483	-0.20949	0.040027
0.13012	-0.094021	0.027365
0.13637	-0.13159	0.010598
0.13379	-0.10182	0.017667
0.13687	-0.11868	0.0094348
0.1294	-0.081217	0.029361
0.10799	-0.052886	0.085747
0.17249	-0.053717	-0.011492
0.12134	-0.063345	0.050658
0.13919	-0.14204	0.0030987
0.13837	-0.16858	0.0049778
0.1791	-0.11932	-0.036831
0.13482	-0.20359	0.013941
0.13791	-0.098798	0.0069
0.13471	-0.083365	0.015427
0.14212	-0.12841	-0.0044207
0.17551	-0.074718	-0.027383
0.14051	-0.10695	1.65E-05
0.14399	-0.15498	-0.0095867
0.129	-0.059624	0.030636
0.13947	-0.087568	0.002918
0.14442	-0.1145	-0.01031
0.14358	-0.19072	-0.0088907
0.14291	-0.095613	-0.0061617
0.11755	-0.033794	0.060884
0.14808	-0.13805	-0.020134
0.13631	-0.062705	0.011445
0.14556	-0.10358	-0.013187
0.16901	-0.095061	-0.037938
0.14952	-0.11903	-0.023729
0.14241	-0.072443	-0.0046327
0.14697	-0.086048	-0.016691
0.15118	-0.17295	-0.028601
0.14952	-0.10118	-0.023544
0.1291	-0.029744	0.030689
0.1569	-0.14906	-0.043356
0.1396	-0.03472	0.003114
0.1584	-0.12219	-0.047
0.15726	-0.094607	-0.043742
0.14883	-0.050393	-0.021217
0.15462	-0.07216	-0.036589];

% Elements
Polygones = [27	26	19	18
56	58	39	38
62	63	30	29
64	65	32	31
28	61	71	70
47	48	81	80
49	50	83	82
51	52	85	84
99	100	60	59
92	91	116	114
141	142	98	97
144	145	103	102
146	147	105	104
148	149	107	106
150	151	109	108
113	157	156	155
117	118	162	161
119	120	164	163
178	158	197	195
159	160	212	211
220	221	229	228
184	183	210	235
181	196	209	182
232	233	234	236
135	136	165	121
226	227	238	240
17	253	252	25
19	255	254	18
241	257	256	20
243	259	258	242
267	277	276	266
270	278	268	269
272	274	279	271
21	261	260	244
248	262	263	249
1	16	44	43
15	14	46	45
40	42	75	73
95	96	57	69
90	89	133	132
78	79	115	134
124	125	170	169
126	127	172	171
130	131	174	129
225	192	139	138
167	168	198	166
180	179	202	201
176	177	194	193
200	218	215	199
188	187	186	231
36	37	24	245
7	6	54	53
5	4	41	55
251	265	264	250
66	67	34	33
152	153	111	110
93	154	137	237
239	72	35	68
86	87	123	122
204	205	223	222
206	207	190	224
29	30	242	241
12	11	49	48
60	61	28	26
98	99	59	58
104	105	70	71
106	107	63	62
80	81	118	117
82	83	120	119
100	144	102	101
114	116	160	159
115	112	158	178
182	183	147	146
184	185	149	148
143	142	196	181
155	156	209	208
161	162	228	213
229	230	233	232
235	210	211	212
163	214	226	240
20	256	255	19
258	272	271	257
31	32	244	243
96	97	56	57
252	266	265	251
261	273	259	260
39	27	18	17
10	9	51	50
8	7	53	52
91	92	79	46
108	109	65	64
200	201	219	218
202	203	221	220
121	84	85	135
254	268	267	253
133	134	177	176
186	187	151	150
193	194	141	140
165	166	215	164
278	279	280	277
37	38	25	24
6	5	55	54
245	250	248	23
262	275	274	263
33	34	22	21
2	1	43	42
172	173	205	204
78	89	44	45
76	77	129	128
90	132	131	130
122	123	168	167
170	180	199	198
217	216	225	191
223	224	188	231
36	35	72	69
41	40	73	74
110	111	67	66
138	139	95	94
68	93	237	239
171	179	125	126
189	190	154	153
174	175	207	206
29	28	70	62
100	101	61	60
102	103	104	71
147	148	106	105
116	117	161	160
118	119	163	162
143	181	145	144
158	155	208	197
157	159	211	156
183	182	209	210
234	235	212	236
242	258	257	241
256	270	269	255
120	121	165	164
215	218	226	214
274	275	280	279
28	29	241	20
11	10	50	49
59	60	26	27
63	64	31	30
101	102	71	61
105	106	62	70
91	80	117	116
81	82	119	118
143	144	100	99
145	146	104	103
149	150	108	107
113	114	159	157
183	184	148	147
142	195	197	196
156	211	210	209
160	161	213	212
186	185	234	233
238	162	163	240
255	269	268	254
257	271	270	256
13	12	48	47
89	78	134	133
187	188	152	151
259	273	272	258
38	39	17	25
9	8	52	51
97	98	58	56
79	92	112	115
135	122	167	136
180	201	200	199
221	222	230	229
24	251	250	245
253	267	266	252
32	33	21	244
67	68	35	34
109	110	66	65
153	154	93	111
205	206	224	223
94	72	239	237
227	219	220	228
74	73	126	125
139	140	96	95
179	171	203	202
69	57	37	36
53	54	87	86
16	15	45	44
42	43	76	75
77	90	130	129
127	128	173	172
193	216	175	176
23	248	249	22
4	3	40	41
191	225	138	137
169	170	198	168
58	59	27	39
48	49	82	81
80	91	46	47
107	108	64	63
201	202	220	219
18	254	253	17
83	84	121	120
26	28	20	19
30	31	243	242
57	56	38	37
140	141	97	96
142	143	99	98
112	113	155	158
136	167	166	165
181	182	146	145
177	178	195	194
163	164	215	214
230	231	186	233
185	184	235	234
197	208	209	196
212	213	232	236
228	162	238	227
25	252	251	24
271	279	278	270
276	277	280	275
65	66	33	32
22	249	261	21
263	274	272	273
52	53	86	85
203	204	222	221
89	90	77	44
111	93	68	67
75	76	128	127
151	152	110	109
123	124	169	168
132	133	176	175
193	192	225	216
190	189	188	224
3	2	42	40
173	174	206	205
250	264	262	248
179	180	170	125
35	36	245	23
54	55	88	87
94	95	69	72
50	51	84	83
92	114	113	112
134	115	178	177
185	186	150	149
194	195	142	141
228	229	232	213
268	278	277	267
14	13	47	46
218	219	227	226
244	260	259	243
266	276	264	265
122	135	85	86
215	166	198	199
222	223	231	230
237	137	138	94
249	263	273	261
73	75	127	126
192	193	140	139
171	172	204	203
188	189	153	152
43	44	77	76
131	132	175	174
34	35	23	22
87	88	124	123
207	217	191	190
264	276	275	262
216	217	207	175
45	46	79	78
88	74	125	124
190	191	137	154
128	129	174	173
55	41	74	88
9	10	293	292
11	12	295	294
13	14	282	296
303	304	315	312
305	306	317	316
325	326	338	324
329	330	342	341
344	345	340	328
350	339	351	352
355	356	369	368
379	380	517	527
381	382	519	518
383	384	521	520
364	365	394	393
404	406	387	386
391	392	421	420
395	396	425	424
397	398	427	426
439	440	412	411
441	442	414	413
443	432	405	415
422	423	450	449
456	458	428	429
462	463	434	433
447	448	472	471
451	452	475	474
453	454	477	476
455	459	479	478
473	487	467	466
490	488	468	494
495	493	492	491
354	367	366	353
319	318	307	308
15	16	283	281
323	337	336	335
402	403	418	431
464	465	436	435
7	8	291	290
313	314	311	300
320	321	333	332
362	363	390	375
370	371	400	399
470	485	438	469
482	489	480	481
377	376	378	528
417	437	496	497
407	408	389	388
498	309	331	499
343	346	359	358
360	361	348	347
419	446	445	444
460	461	457	430
3	4	287	286
284	285	298	297
288	289	302	301
292	293	304	303
294	295	306	305
296	282	308	307
315	316	326	325
317	318	328	327
339	340	353	351
354	355	368	367
356	357	370	369
363	364	393	392
365	366	395	394
405	404	384	383
412	413	380	379
414	415	382	381
396	397	426	425
398	399	428	427
432	433	407	406
421	422	449	448
423	424	451	450
466	467	441	440
468	462	443	442
452	453	476	475
454	455	478	477
472	439	486	471
488	480	464	463
474	493	487	473
495	491	490	494
458	456	481	459
499	329	319	498
385	386	523	522
309	310	320	331
330	332	343	342
350	352	362	349
361	360	375	374
387	388	525	524
378	376	416	411
419	420	447	446
516	529	377	528
469	438	497	496
323	324	338	337
434	435	409	408
444	445	484	460
283	284	297	281
285	286	299	298
290	291	302	289
335	336	347	334
358	359	372	371
390	391	418	403
400	401	430	429
4	5	288	287
312	313	300	301
465	489	482	483
311	314	322	321
436	437	417	410
382	383	520	519
413	414	381	380
394	395	424	423
425	426	453	452
467	468	442	441
448	449	466	472
450	451	474	473
477	492	475	476
495	494	487	493
14	15	281	282
8	9	292	291
10	11	294	293
12	13	296	295
384	385	522	521
486	439	438	485
490	491	478	479
316	317	327	326
318	319	329	328
338	339	350	337
344	341	356	355
352	351	365	364
378	379	527	528
380	381	518	517
366	367	396	395
368	369	398	397
393	394	423	422
405	432	406	404
440	441	413	412
442	443	415	414
420	421	448	447
424	425	452	451
426	427	454	453
458	459	455	428
449	450	473	466
492	493	474	475
494	468	467	487
353	340	345	354
6	7	290	289
312	315	325	313
357	358	371	370
363	392	391	390
433	434	408	407
16	1	284	283
2	3	286	285
373	374	403	402
287	288	301	300
360	349	362	375
386	387	524	523
445	446	470	469
456	457	482	481
480	489	465	464
437	483	484	496
314	324	323	322
388	389	526	525
376	410	417	416
331	320	332	330
297	298	309	498
347	348	359	346
418	419	444	431
306	307	318	317
327	328	340	339
345	344	355	354
341	342	357	356
352	364	363	362
351	353	366	365
367	368	397	396
369	370	399	398
411	412	379	378
392	393	422	421
427	428	455	454
443	462	433	432
463	464	435	434
293	294	305	304
488	490	479	480
291	292	303	302
384	404	386	385
415	405	383	382
472	466	440	439
471	486	485	470
491	492	477	478
498	319	308	297
5	6	289	288
298	299	310	309
406	407	388	387
391	420	419	418
429	430	457	456
330	329	499	331
336	337	350	349
314	313	325	324
332	333	346	343
497	438	416	417
1	2	285	284
371	372	401	400
374	375	390	403
322	323	335	334
526	389	377	529
496	484	445	469
465	483	437	436
304	305	316	315
446	447	471	470
295	296	307	306
438	439	411	416
326	327	339	338
341	344	328	329
399	400	429	428
459	481	480	479
457	461	483	482
468	488	463	462
302	303	312	301
342	343	358	357
349	360	347	336
308	282	281	297
348	361	374	373
299	300	311	310
408	409	377	389
401	402	431	430
321	322	334	333
333	334	347	346
310	311	321	320
409	410	376	377
372	373	402	401
286	287	300	299
444	460	430	431
359	348	373	372
435	436	410	409
461	460	484	483
606	595	607	618
583	570	596	603
567	561	589	592
754	737	763	764
724	706	758	761
683	680	738	748
674	669	711	726
667	666	690	701
668	679	694	687
628	627	643	644
625	623	636	639
663	658	675	681
655	649	665	670
645	640	657	661
634	632	647	650
631	637	652	648
566	557	562	573
544	541	550	556
536	540	549	548
588	590	601	602
591	580	587	599
575	517	560	579
518	519	542	551
520	521	531	535
528	527	574	516
614	619	638	633
622	629	646	641
558	571	585	572
525	526	563	555
604	610	626	621
522	523	537	534
654	653	673	672
584	586	600	598
564	569	597	593
656	660	682	676
664	671	716	691
677	678	742	733
635	642	659	651
581	594	609	605
543	552	559	554
595	583	603	607
570	567	592	596
737	724	761	763
706	683	748	758
680	674	726	738
669	667	701	711
666	668	687	690
627	625	639	643
623	618	630	636
658	655	670	675
649	645	661	665
640	634	650	657
632	631	648	647
580	566	573	587
557	544	556	562
541	536	548	550
590	591	599	601
574	575	588	586
517	518	551	560
519	520	535	542
521	522	534	531
561	564	593	589
594	604	621	609
716	733	765	762
742	754	764	766
626	628	644	642
651	659	677	671
678	663	681	698
569	581	605	597
652	637	654	662
633	638	656	653
600	602	617	616
540	543	554	549
552	558	572	559
571	584	598	585
529	516	563	526
523	524	546	537
641	646	664	660
665	661	680	683
657	650	669	674
618	607	624	630
603	596	615	620
599	587	606	608
573	562	583	595
560	551	557	566
590	579	580	591
527	517	575	574
681	675	724	737
670	665	683	706
661	657	674	680
650	647	667	669
648	652	668	666
607	603	620	624
596	592	611	615
643	639	655	658
636	630	645	649
601	599	608	613
587	573	595	606
562	556	570	583
550	548	561	567
586	588	602	600
579	560	566	580
551	542	544	557
535	531	536	541
662	654	672	679
653	656	676	673
534	537	543	540
678	698	754	742
589	593	614	612
642	644	663	659
524	525	555	546
616	617	627	628
597	605	622	619
549	554	569	564
559	572	594	581
563	516	584	571
671	677	733	716
585	598	610	604
660	664	691	682
609	621	635	629
698	681	737	754
675	670	706	724
647	648	666	667
652	662	679	668
592	589	612	611
644	643	658	663
639	636	649	655
602	601	613	617
556	550	567	570
548	549	564	561
542	535	541	544
531	534	540	536
608	606	618	623
630	624	640	645
620	615	632	634
598	600	616	610
554	559	581	569
516	574	586	584
575	579	590	588
733	742	766	765
621	626	642	635
638	641	660	656
646	651	671	664
555	563	571	558
672	673	715	702
637	633	653	654
572	585	604	594
537	546	552	543
676	682	750	732
593	597	619	614
605	609	629	622
613	608	623	625
679	672	702	694
673	676	732	715
624	620	634	640
615	611	631	632
691	716	762	760
659	663	678	677
612	614	633	637
610	616	628	626
619	622	641	638
629	635	651	646
546	555	558	552
617	613	625	627
611	612	637	631
682	691	760	750];

%__________________________________________________________________________
%
% 3D Scaling
%__________________________________________________________________________

% Affine (least squares)
[Meshj_ls,Rotation_ls,Translation_ls,Homothety_ls,Stretch_ls,SSE_ls] = ...
    Affine_3D_Approximation(Meshi,Xi,Xj);
% Translation with only rotation 
Translation_ls = mean(Xj',2) - Rotation_ls*mean(Xi',2); % Overwrite

% Kriging
[Meshj_kg,Rotation_kg,Translation_kg,Homothety_kg,Stretch_kg,  ...
    Model_kg,SSE_kg] = Kriging_3D_Interpolation(Meshi,Xi,Xj);
% Translation with only rotation 
Translation_kg = mean(Xj',2) - Rotation_kg*mean(Xi',2); % Overwrite

% RBF
[Meshj_rbf,Rotation_rbf,Translation_rbf,Homothety_rbf,Stretch_rbf,  ...
    Model_rbf,Center_rbf,SSE_rbf] = RBF_3D_Approximation(Meshi,Xi,Xj,0,0);
% Translation with only rotation 
Translation_rbf = mean(Xj',2) - Rotation_rbf*mean(Xi',2); % Overwrite


%__________________________________________________________________________
%
% Figure of scaled models 
%__________________________________________________________________________

figure
hold on
axis equal
title ('Scaling from Male to Female dummy leg');

% Initial
plot3(Xi(:,1),Xi(:,2),Xi(:,3),'dy');
p_i = patch('vertices',Meshi,'faces',Polygones);
set(p_i,'FaceColor','none','EdgeColor','y');
plot3(Xj(:,1),Xj(:,2),Xj(:,3),'dr');

% Affine (least squares)
p_ls = patch('vertices',Meshj_ls,'faces',Polygones);
set(p_ls,'FaceColor','none','EdgeColor','g');

% Kriging
p_kg = patch('vertices',Meshj_kg,'faces',Polygones);
set(p_kg,'FaceColor','none','EdgeColor','r');

% RBF
Ind_c = []; % RaZ
for i = 1:size(Center_rbf,1)
    Ind_c(i,:) = find(Xi(:,1) == Center_rbf(i,1));
end
plot3(Xj(Ind_c,1),Xj(Ind_c,2),Xj(Ind_c,3),'sb');
p_rbf = patch('vertices',Meshj_rbf,'faces',Polygones);
set(p_rbf,'FaceColor','none','EdgeColor','b');

% Legend
legend('Initial Control Points','Initial Mesh','Final Control points', ...
'Final Mesh (Affine)', ...
'Final Mesh (Kriging)', ...
'Selected Center','Final Mesh (RBF)');


%__________________________________________________________________________
%
% Figure of some geometrical information 
%__________________________________________________________________________

% Rotation (ZYX fixed sequence of Euler angles)
% Affine (least squares)
Euler_Angles_ls(1,1,:) = atan2(-Rotation_ls(1,2,:), ...
    Rotation_ls(1,1,:))*180/pi; % Phi (about Z ICS axis)
Euler_Angles_ls(1,2,:) = asin(Rotation_ls(1,3,:))*180/pi; % Theta (about Y ICS axis)
Euler_Angles_ls(1,3,:) = atan2(-Rotation_ls(2,3,:), ...
    Rotation_ls(3,3,:))*180/pi; % Psi (about X ICS axis)
% Kriging
Euler_Angles_kg(1,1,:) = atan2(-Rotation_kg(1,2,:), ...
    Rotation_kg(1,1,:))*180/pi; % Phi (about Z ICS axis)
Euler_Angles_kg(1,2,:) = asin(Rotation_kg(1,3,:))*180/pi; % Theta (about Y ICS axis)
Euler_Angles_kg(1,3,:) = atan2(-Rotation_kg(2,3,:), ...
    Rotation_kg(3,3,:))*180/pi; % Psi (about X ICS axis)
% RBF
Euler_Angles_rbf(1,1,:) = atan2(-Rotation_rbf(1,2,:), ...
    Rotation_rbf(1,1,:))*180/pi; % Phi (about Z ICS axis)
Euler_Angles_rbf(1,2,:) = asin(Rotation_rbf(1,3,:))*180/pi; % Theta (about Y ICS axis)
Euler_Angles_rbf(1,3,:) = atan2(-Rotation_rbf(2,3,:), ...
    Rotation_rbf(3,3,:))*180/pi; % Psi (about X ICS axis)

% Figure rotation
figure
hold on
bar3([Euler_Angles_ls',...
    Euler_Angles_kg', ...
    Euler_Angles_rbf']);
title ('Rotation (ZYX fixed sequence of Euler angles)');
legend('Affine','Kriging','RBF');
xlabel('Method');
ylabel('angles phi, theta, psi');
zlabel('value in °');

% Figure translation
figure
hold on
bar3([Translation_ls,...
    Translation_kg, ...
    Translation_rbf]);
title ('Translation');
legend('Affine','Kriging','RBF');
xlabel('Method');
ylabel('X axis, Y axis, Z axis');
zlabel('value in m');

% Figure homothety
figure
hold on
bar3([diag(Homothety_ls),...
    diag(Homothety_kg), ...
    diag(Homothety_rbf)]);
title ('Honothethy');
legend('Affine','Kriging','RBF');
xlabel('Method');
ylabel('X axis, Y axis, Z axis');

% Figure stretch
figure
hold on
bar3([diag(Stretch_ls),...
    diag(Stretch_kg), ...
    diag(Stretch_rbf)]);
title ('Stretch');
legend('Affine','Kriging','RBF');
xlabel('Method');
ylabel('X axis, Y axis, Z axis');
